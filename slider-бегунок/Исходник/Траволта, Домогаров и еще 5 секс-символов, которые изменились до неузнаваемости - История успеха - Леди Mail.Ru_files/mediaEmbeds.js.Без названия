!function(t,e,i){"use strict";function n(t){if(t&&t.length){var i=h.trigger.bind(h,"resize");t.forEach(function(t){t in p&&p[t]()}),e.requestAnimationFrame(i),setTimeout(i,2e3)}}function s(t){var e;t=t.split("?")[0],-1===d.indexOf(t)&&(d.push(t),e=document.createElement("script"),e.type="text/javascript",e.setAttribute("defer","defer"),e.src=t+"?"+(Math.random()+"").split(".")[1],l.appendChild(e))}function r(t){if(!t||!t.length)return!1;if(t.is("iframe"))return!0;var e=t.find("iframe");return!!e.length}function a(e,i,n){return new Promise(function(s,a){var c=n.closestParent?e.closest(n.closestParent):t(e.get(0).parentNode);setTimeout(function(){var t=v[i]||r,e={element:c.get(0),type:i};t(c)?s(e):a(e)},n.loadTimeout)})}function c(){var t=i.Basic.moduleOpts.get("ActivateEmbeds")||{};t.initializers&&(p=i.Basic.Extend(p,t.initializers))}function o(i,r){m||(c(),m=!0);var o=[],l=[],h=u(!0,{},f,r||{}),d=h.checkRawItems||{};return i.each(function(i,n){var r=n.getAttribute("data-type");if(!d[r]||d[r](n,r)!==!1){var c=t(),u=n.value.replace(/__text_area__/g,"textarea"),m=t(n),f=[];t(u).each(function(e,i){var n;"SCRIPT"===i.tagName?i.src?s(i.src):(n=document.createElement("script"),n.type="text/javascript","textContent"in n?n.textContent=i.textContent:n=['<script type="text/javascript">',t(i).html(),"</script>"].join(""),f.push(n)):c=c.add(i)}),-1===o.indexOf(r)&&o.push(r),l.push(a(m,r,h)["catch"](function(t){DEBUG&&console.log("Embed "+t.type+" не загрузился")})),m.replaceWith(c),f.length&&f.forEach(function(t){document.head.appendChild(t)}),e.requestAnimationFrame(c.trigger.bind(c,"documentHeightChange"))}}),e.requestAnimationFrame(n.bind(this,o)),l}var u=i.Basic.Extend,l=t("head")[0],h=t(e),d=[],m=!1,f={loadTimeout:5e3,closestParent:null,checkRawItems:function(){var t=function(t){var i=e.Modernizr;return i&&"boolean"==typeof i[t]?i[t]:!0},i=function(e){var i=t("webaudio");return i||e.parentNode.removeChild(e),i};return{soundcloud:i,rutube:i}}()},p={instagram:function(t){e.instgrm&&e.instgrm.Embeds&&e.instgrm.Embeds.process(t)},facebook:function(t){e.FB&&e.FB.XFBML&&e.FB.XFBML.parse(t)},twitter:function(t){e.twttr&&e.twttr.widgets&&e.twttr.widgets.load(t)}},v={various:function(){return!0}};e.getNameSpace("Tools",i,!0).activateEmbeds=o}(this.jQuery||this.$||this.$f,this,this.ru.mail.cpf),function(t,e,i){"use strict";var n=i.Basic,s=n.throttle,r=i.Tools.activateEmbeds,a=t(e),c=/iphone|ipod/i.test(navigator.userAgent),o={SCROLL:"scroll",CUSTOM_SCROLL:"touchend"},u="ru.mail.media.parallaxSlot",l=o.SCROLL,h={cssSels:{item:".js-wysiwyg__embedcode"},scrollLimit:400,loadTimeout:5e3,failHandler:null,checkRawItems:{}},d=function(){if(m(this._Elems.Parent)){var e,i=this._state.winSizes.height+this._Opts.scrollLimit;this._state.items.forEach(function(n){n.getBoundingClientRect().top<i&&(e=(e||t()).add(n))}),e&&this.initItemsCode(e)}},m=function(e){var i="is"in t.prototype?function(t){return t.is(":visible")}:function(t){return t.isVisible()};return m=i,i(e)},f=function(){this._state.winSize=p(),e.requestAnimationFrame(d.bind(this))},p=function(){var t=e.document.documentElement;return{height:t.clientHeight,width:t.clientWidth}},v=function(t){var e,i=this._state;i.areListernersActive!==t&&(i.areListernersActive=t,t?(e="on",i.handlers={resize:s(f.bind(this),100),scroll:s(d.bind(this),100)}):e="off",a[e]("resize",i.handlers.resize),a[e](l,i.handlers.scroll))},g=function(t){var e=this._state.items;t.each(function(t,i){var n=e.indexOf(i);-1!==n&&e.splice(n,1)})},b=function(){return{loadTimeout:this._Opts.loadTimeout,checkRawItems:this._Opts.checkRawItems||{}}},_=n.Constructors.getView({_Init:function(){this._state={items:[],winSizes:p(),handlers:{}},c&&u in e&&(l=o.CUSTOM_SCROLL),this.processItems(),this._state.items.length&&a.on("load",s(f.bind(this),100))},processItems:function(t){var e=this._state,i=t||this._Elems.Parent,n=this._Opts.cssSels.item,s=i.find(n).removeClass(n.slice(1));e.items=e.items.concat(Array.prototype.slice.call(s)),e.items.length&&(v.call(this,!0),d.call(this))},initItemsCode:function(t){var e=this._Opts.failHandler,i=r(t,b.call(this));g.call(this,t),this._state.items.length||v.call(this,!1),"function"==typeof e&&(e=e.bind(this),i.forEach(function(t){t.then(null,e)}))}},h,null,"MediaEmbeds");e.getNameSpace("Modules",i).MediaEmbeds=_}(this.jQuery||this.$||this.$f,this,this.ru.mail.cpf),function(t){"use strict";var e=t.Basic.moduleOpts.set;e("MediaEmbeds",{cssSels:{item:".js-media-embed"}})}(this.ru.mail.cpf);
