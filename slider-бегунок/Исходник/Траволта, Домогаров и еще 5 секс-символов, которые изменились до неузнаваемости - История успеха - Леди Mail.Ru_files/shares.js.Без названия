!function(t,s,e){"use strict";var a="Shares",r=e.Basic.typeOf,n=e.Basic.Extend,i=e.Basic.getView,l=e.Basic.moduleOpts.setParams,u=s.getNameSpace,o={cssSels:{Main:{Btns:".js-shares_btn",Cnts:".js-shares_cnt",Total:".js-shares_total",countCont:null}},cssClss:{hideCount:"hidden_all",hidden:"hidden_all"},showCnt:!0,getCntOnInit:!0,typeAttr:"data-share",urlTypeParam:"social",url2Share:null,Counters:null,addParams:null,shareParams:{Title:null,Description:null,Image:null},prepareParams:function(t,s){var e=t.Tweet;"tw"==s&&e&&(t.Title=e)},ignoreMetaParams:navigator.userAgent.toLowerCase().indexOf("msie")>-1},c={my:{baseUrl:"//connect.mail.ru/",url:"share",count:"share_count?callback=1",countUseCallback:!0,getCount:function(t,s){var e;return t&&(e=t[s])&&e.shares||0},sizes:[550,340],params:{url:"share_url",title:"title",description:"description",image:"imageurl"},countParams:{url:"url_list",callback:"func"}},ok:{baseUrl:"//connect.ok.ru/",url:"dk?st.cmd=WidgetSharePreview",count:"dk?st.cmd=extLike",countUseCallback:!1,getCount:null,sizes:[550,320],params:{url:"st.shareUrl"},countParams:{url:"ref",id:"uid",callback:"callback"},serializeOptions:{getParamName:function(t,s){return t+"."+s}}},fb:{baseUrl:null,url:"//www.facebook.com/sharer.php",count:"//graph.facebook.com/",countUseCallback:!0,getCount:function(t){var s=0;return t&&t.share&&(s=t.share.share_count||s),s},sizes:[660,370],params:{url:"p[url]",title:"p[title]",description:"p[summary]",image:"p[images][0]",_url:"u"},countParams:{url:"urls",callback:"callback"},addParams:{s:100}},vk:{baseUrl:"//vk.com/",url:"share.php",count:"share.php?act=count&format=json",countUseCallback:!1,getCount:null,sizes:[660,390],params:{url:"url",title:"title",description:"description",image:"image"},countParams:{url:"url",id:"index",callback:"callback"}},tw:{baseUrl:null,url:"https://twitter.com/share",count:null,countUseCallback:!0,getCount:null,sizes:[550,300],charsLimit:114,params:{url:"url",via:"via"},countParams:{url:"url",callback:"callback"}}};i(function(){var a=e.Types.String,i=a.Url,l="//r.mail.ru/",o=/cl(?:n|b|s|r)/i,h="shareType",p={title:"Title",description:"Description",image:"Image"},m={title:100,descr:500},d=["url","image","title","description"],f=function(){var t={};return function(s,e,a){e=r(e,"undefined")?this.url2Share:e;var n,l=s+e,u=t[l];return!a&&u?u:(u=i.getAbs(e),"object"==r(this._opts.urlParams)&&(u=i.addParams(this._opts.urlParams,u)),n=this._opts.urlTypeParam,u&&s?(null!==n&&(u=i.addParam(u,n?n:s,n?s:null)),l&&(t[l]=u),u):null)}}(),C=function(t,s){var e;if(s){if("object"==(e=r(s)))return s[t];if("string"==e)return s}},_=function(){var a,l={},o=function(t,s,e){var n,i;a&&(n=a[t])&&r(i=n[s],"function")&&(n[s]=null,i.call(null,e))},h=function(){var t={updateCount:function(t,s){o.apply(null,["ok",t,s])}},e={Share:{count:function(t,s){o.apply(null,["vk",t,s])}}};s.ODKL=n(s.ODKL,t),s.VK=n(s.VK,e)},p=function(t,s){var e=l[t];return s=f.apply(this,[t,s]),e&&e[s]},m=function(t){var s,e=this._elemsByType[t],a=e.Count;a&&a.length&&(s=isNaN(s=p.call(this,t))?0:s,a.text(s),this._opts.cssClss.hideCount?e.countCont.toggleClass(this._opts.cssClss.hideCount,0===s):e.countCont.toggle(s>0))},d=function(t,s,e){var a=l[s];isNaN(t=1*t)||(r(a,"object")||(l[s]=a={}),a[e]=t,this._trigger("typeCount",s,t),e===f.call(this,s)&&m.call(this,s))},C=function(t,s){var n,i;return r(a,"object")||(i=u("Instances",e),i.oShareCallbacks?a=i.oShareCallbacks:i.oShareCallbacks=a={}),(n=a[t])instanceof Array||(n=a[t]=[]),n.push(s)-1},_=function(s){var e=this,a=c[s];if(null!==a.count){var r,n=a.countParams,l=a.countUseCallback,u=f.call(this,s),o={};o[n.url]=u,l||(o[n.id]=C.apply(this,[s,function(t){d.apply(e,[t,s,u])}])),n.url&&(o[n.callback]="?"),r=i.addParams(o,(a.baseUrl||"")+a.count,a.serializeOptions),h(),t.getJSON(r,l?function(t){var r=a.getCount(t,u);d.apply(e,[r,s,u])}:null)}},g=function(t,s){var e=p.call(this,t);return isNaN(e)||s===!0?_.call(this,t):m.call(this,t),e};return{getTypeCount:g,initCbcks:h}}(),g=_.getTypeCount,v=function(){var t=this.Types;if(t)for(var s=0;s<t.length;s++)g.call(this,t[s])},b=function(t,s){return t&&(s=t.add(s)),s},y=function(){var s=this._elems.Cnts,e=this._elems.countCont,a=this._opts,r=a.typeAttr,n=this._elemsByType={},i=this.Types=[];this._elems.Btns&&this._elems.Btns.toArray().forEach(function(l,u){var o,c=t(l),p=c.attr(r)||c.data(h),m=n[p]={};p&&(-1===i.indexOf(p)&&i.push(p),c.removeAttr(r).data(h,p),m.Btn=b(m.Btn,c),a.showCnt&&s&&(o=s.eq(u),o.length&&(m.Count=b(m.Count,o),m.countCont=b(m.countCont,e&&e.eq(u)||o))))})},T=function(){function e(){var s={};return t("meta",document.head).each(function(){var t,e=this.getAttribute("property")||this.getAttribute("name");e&&("description"===e||(t=e.split(":"))&&2===t.length&&"og"===t.shift())&&(s[t&&t.shift()||e]=this.getAttribute("content"))}),s}var u=function(t){var s=this,e=this._Timers.ppCheckTimer;e&&(clearTimeout(e),this.ppCheckTimer=null,g.call(this,t,!0)),this._Timers.ppCheckTimer=setTimeout(function(){var e;s._Timers.ppCheckTimer=null;try{s.curWin.closed?(e=g.call(s,t,!0),s._trigger("windowClose",t,e)):u.call(s,t)}catch(a){}},500)},h=function(t){var s,i,l,u,o,h=n({},this._shareParams),d=this._opts,f=h.via,C=d.prepareParams,_=d.ignoreMetaParams!==!0,g={},v=!1;if(r(C,"function")&&C.call(this,h,t),_&&(s=e()),"tw"!=t)for(var b in p)p.hasOwnProperty(b)&&(i=h[p[b]]||_&&s[b])&&((l=m[b])&&i.length>l&&(l-=3,i=i.substr(0,l)+(" "!=i.charAt(l)?"...":"")),g[b]=i,v=!0);else v=!0,u=h.Title||document.title,u=u.replace(/\"/g,""),o=c[t].charsLimit,f&&(g.via=f,v=!0,o-=11+f.length),u.length>o&&(u=a.cutBySpace(u,o-3)+"..."),g.text=u;return v?g:null},_=function(){var t={};return function(s){var e,a,n,i,u=t[s];return u?u:(e=c[s],a=this._opts.Counters,n=(e.baseUrl||"")+e.url,a&&(i=C(s,a))&&(i=l+(r(i,"string")&&o.test(i)?"":"cln")+i),t[s]=u=i?i+"/"+n.replace(/^(http(s)?:)?\/\//i,""):n,u)}}(),v=function(t){var s,e,a,r,l=this._opts.addParams,u=f.call(this,t),o=c[t],p=o.params,m=o.serializeOptions||{},g=o.addParams,v=_.call(this,t),b={};if(!u)return null;a=h.call(this,t),r=null!==a,b.url=u,r&&n(b,a);for(var y=0;y<d.length;y++)if(s=d[y],e=b[s]){delete b[s],"fb"!==t||r||"url"!==s||(s="_url");var T=p[s];T&&(v=i.addParam(v,T,e,m))}return g&&n(b,g),l&&n(b,C(t,l)),i.addParams(b,v,m)},b=function(t){for(var s,e,a,r=[],n=0;n<t.length;n++)s=t[n],e=n?"height":"width",a=n?"top":"left",r.push(e+"="+s,a+"="+Math.max(0,Math.round(screen[e]/2-s/2)));return r.join(",")};return function(t){var e,a=v.call(this,t),r=c[t];if(a&&r){if(e=this.curWin)try{e.close()}catch(n){}this.curWin=s.open(a,"share",b(r.sizes)+",personalbar=0,toolbar=0,scrollbars=1,resizable=1"),u.call(this,t)}}}(),P=function(s){s.preventDefault();var e=t(s.currentTarget);T.call(this,e.data(h))};return{_Events:["typeCount","windowClose"],_Handlers:{dom:{"click:Main.Btns":P}},_Init:function(){this.url2Share=this._opts.url2Share||t(s.document.head).find("link[rel=canonical]").attr("href")||s.location.href,this._shareParams=this._opts.shareParams,this._Timers={},y.apply(this),this._opts.showCnt&&this._opts.getCntOnInit===!0&&v.apply(this)},setUrl2Share:function(t,s,e){var a;t&&r(t,"string")&&(this.url2Share=t,s&&((r(e,"undefined")?!0:e)?this._shareParams=n(!0,{},s):this._shareParams=n(!0,this._shareParams,s)),this._opts.showCnt&&((a=this._elems.countCont||this._elems.Cnts)&&(this._opts.cssClss.hideCount?a.addClass(this._opts.cssClss.hideCount):a.hide()),v.apply(this)))},updateElementsSet:function(t){this._elems=function(t,s,e){return t.Main&&s.length&&Object.keys(t.Main).forEach(function(a){e[a]||(e[a]=s.find(t.Main[a]))}),e}(this._opts.cssSels,t,{parent:t}),y.apply(this)}}}(),o,null,a),l(a,{options:{_Handlers:{typeCount:function(t,s){var e=this._totalCount=this._totalCount||{};e[t]=s;var a=0;for(var r in e)e.hasOwnProperty(r)&&(a+=e[r]);this._elems.Total&&(this._elems.Total.text(a),this._elems.Total.toggleClass(this._opts.cssClss.hidden,0>=a))}}},paramAttrs:{shareParams:{Tweet:"data-twshare"},url2Share:"data-url2share"}})}(jQuery,this,this.ru.mail.cpf),function(t,s,e){"use strict";var a="User",r="Shares",n=e.Tools.Auth,i=(s.__PH,e.Basic.Constructors.addPlugin),l={cssSels:{Main:{user:".js-shares_user"}},cssClss:{hidden:"hidden_all"},getUserText:function(){return"OH, HAI, %username%!"}};i(r,function(){var t=function(t){var s=this._opts.getUserText.bind(this),e=(t||[]).filter(function(t){return t.active})[0];if(e){var a=s(e);this.updateUserText(a)}},s=function(){var t=this._opts.getUserText.bind(this),s=t();this.updateUserText(s)};return{_Init:function(){this._elems.user&&n.getAccountsList().then(t.bind(this))["catch"](s.bind(this))},updateUserText:function(t){this._elems.user.html(t),this._elems.user.removeClass(this._opts.cssClss.hidden)}}}(),l,a)}(this.jQuery||this.$,this,this.ru.mail.cpf),function(t){"use strict";var s=t.Basic.moduleOpts.setParams;s("Shares",{options:{getCntOnInit:!0,urlTypeParam:"social"}}),s("Shares.Compact",{options:{cssSels:{Total:".js-shares__total"},cssClss:{hidden:"hidden_all"},Handlers:{typeCount:function(t,s){var e=this._totalCount=this._totalCount||{};e[t]=s;var a=0;for(var r in e)e.hasOwnProperty(r)&&(a+=e[r]);var n=this.Elems.jTotal;n&&(n.text(a),n.toggleClass(this.Opts.cssClss.hidden,0>=a))}},showCnt:!0,getCntOnInit:!0,getUserText:function(t){if(t&&t.firstName){var s=this._opts.userText||"поделись с друзьями!";return $("<span/>").append($("<strong/>").text(t.firstName)).append($("<span/>").text(", "+s))}return this._opts.userText?"Привет, "+this._opts.userText:"Поделись с друзьями!"}}}),s("Shares.PopupGalleryView",{options:{ignoreMetaParams:!0,cssSels:{countCont:".js-shares_cnt_cont"}}})}(this.ru.mail.cpf);
